// static/script.js

// ============== TRANSLATION SETUP ==============
let currentLanguage = 'en';

// --- Comprehensive translation object including all dynamic questions ---
const translations = {
    en: {
        // Static UI Text
        headerTitle: "ЁЯзСтАНЁЯМ╛ Agri-AI Diagnostics",
        headerLead: "Upload a crop or insect image for a complete analysis.",
        translateButton: "Translate",
        step1Title: "Step 1: Upload Image",
        uploadLabel: "ЁЯМ┐ Upload Image (Crop or Insect)",
        analyzeButton: "Analyze Image",
        loadingSpinner: "Loading...",
        step2Title: "Step 2: Answer a Few Questions",
        step2Lead: "Please provide additional information based on the image below and your observations.",
        getDiagnosisButton: "Get Final Diagnosis",
        resultsTitle: "Final Analysis",
        resetButton: "Analyze Another Crop",
        diseaseSectionTitle: "Dead-Heart Symptoms",
        insectSectionTitle: "Larva Symptoms",
        yes: "Yes",
        no: "No",
        diseaseAnalysisTitle: "ЁЯМ┐ Disease Analysis (Dead Heart)",
        insectAnalysisTitle: "ЁЯРЫ Insect Analysis",
        finalDiagnosisLabel: "Final Diagnosis:",
        visualDetectionLabel: "Visual Detection (Image):",
        symptomAnalysisLabel: "Symptom Analysis (TabNet):",
        fusedCertaintyLabel: "Fused Certainty:",
        // Dynamic Questions (Your full English to English mapping)
        dynamic_questions: {
            "Have you seen the central growing point of the stalk damaged or dead?": "Have you seen the central growing point of the stalk damaged or dead?",
            "Is the dead central shoot straw-coloured?": "Is the dead central shoot straw-coloured?",
            "After pulling the dead-heart, do you find maggots that look like secondary feeders (not primary borers)?": "After pulling the dead-heart, do you find maggots that look like secondary feeders (not primary borers)?",
            "After pulling the dead-heart, do you find fresh live larvae inside the affected stem?": "After pulling the dead-heart, do you find fresh live larvae inside the affected stem?",
            "Is most of the visible damage inside the stem rather than outside?": "Is most of the visible damage inside the stem rather than outside?",
            "Have you noticed insect attack when the leaves are still developing and soft?": "Have you noticed insect attack when the leaves are still developing and soft?",
            "Was the crop planted within the last 15 days?": "Was the crop planted within the last 15 days?",
            "Have you never seen moths flying during daytime?": "Have you never seen moths flying during daytime?",
            "Have you observed mating or egg-laying activity mostly at night?": "Have you observed mating or egg-laying activity mostly at night?",
            "Were any biological control insects released in the field?": "Were any biological control insects released in the field?",
            "Have you seen fully grown moths that are straw to light brown in colour?": "Have you seen fully grown moths that are straw to light brown in colour?",
            "Is the central shoot of young plants dry, brown, or straw-colored?": "Is the central shoot of young plants dry, brown, or straw-colored?",
            "Does the central shoot come out easily when pulled gently?": "Does the central shoot come out easily when pulled gently?",
            "Does the pulled shoot emit a foul or rotten odor?": "Does the pulled shoot emit a foul or rotten odor?",
            "Are leaves around the central shoot yellowing, wilting, or drying?": "Are leaves around the central shoot yellowing, wilting, or drying?",
            "Do patches of plants show multiple stalks with dried or dead centers?": "Do patches of plants show multiple stalks with dried or dead centers?",
            "Has the percentage of dead hearts increased after recent rains or waterlogging?": "Has the percentage of dead hearts increased after recent rains or waterlogging?",
            "Are affected plants stunted or shorter than surrounding healthy plants?": "Are affected plants stunted or shorter than surrounding healthy plants?",
            "Do affected plants fail to produce new green shoots or leaves?": "Do affected plants fail to produce new green shoots or leaves?",
            "Are there soft, hollow, or tunnel-like areas inside the affected stalks?": "Are there soft, hollow, or tunnel-like areas inside the affected stalks?",
            "Have you seen bunchy or abnormal growth at the top of affected stalks?": "Have you seen bunchy or abnormal growth at the top of affected stalks?",
            "Are soil moisture and drainage poor in areas where dead hearts appear?": "Are soil moisture and drainage poor in areas where dead hearts appear?",
            "Are there no dry central shoots in the field?": "Are there no dry central shoots in the field?",
            "Is plant height uniform and normal throughout the field?": "Is plant height uniform and normal throughout the field?",
            "When pulling the central shoot, is it firmly attached without coming out easily?": "When pulling the central shoot, is it firmly attached without coming out easily?",
            "Does the shoot base smell fresh with no rotting or foul odor?": "Does the shoot base smell fresh with no rotting or foul odor?",
            "Are leaves healthy, green, and not wilting near the central shoot?": "Are leaves healthy, green, and not wilting near the central shoot?",
            "Do you have no patches with multiple dead or dried shoots?": "Do you have no patches with multiple dead or dried shoots?",
            "Have symptoms decreased after improved irrigation or fertilization?": "Have symptoms decreased after improved irrigation or fertilization?",
            "Is there no recurrence of dead heart symptoms from previous seasons?": "Is there no recurrence of dead heart symptoms from previous seasons?"
        }
    },
    ta: {
        // Static UI Text
        headerTitle: "ЁЯзСтАНЁЯМ╛ роЕроХрпНро░ро┐-AI роХрогрпНроЯро▒ро┐родро▓рпН",
        headerLead: "роорпБро┤рпБроорпИропро╛рой рокроХрпБрокрпНрокро╛ропрпНро╡ро┐ро▒рпНроХрпБ рокропро┐ро░рпН роЕро▓рпНро▓родрпБ рокрпВроЪрпНроЪро┐ рокроЯродрпНродрпИ рокродро┐ро╡рпЗро▒рпНро▒ро╡рпБроорпН.",
        translateButton: "роорпЖро╛ро┤ро┐рокрпЖропро░рпН",
        step1Title: "рокроЯро┐ 1: рокроЯродрпНродрпИ рокродро┐ро╡рпЗро▒рпНро▒ро╡рпБроорпН",
        uploadLabel: "ЁЯМ┐ рокроЯродрпНродрпИ рокродро┐ро╡рпЗро▒рпНро▒ро╡рпБроорпН (рокропро┐ро░рпН роЕро▓рпНро▓родрпБ рокрпВроЪрпНроЪро┐)",
        analyzeButton: "рокроЯродрпНродрпИ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН",
        loadingSpinner: "роПро▒рпНро▒рпБроХро┐ро▒родрпБ...",
        step2Title: "рокроЯро┐ 2: роЪро┐ро▓ роХрпЗро│рпНро╡ро┐роХро│рпБроХрпНроХрпБ рокродро┐ро▓ро│ро┐роХрпНроХро╡рпБроорпН",
        step2Lead: "роХрпАро┤рпЗропрпБро│рпНро│ рокроЯроорпН рооро▒рпНро▒рпБроорпН роЙроЩрпНроХро│рпН роЕро╡родро╛ройро┐рокрпНрокрпБроХро│ро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН роХрпВроЯрпБродро▓рпН родроХро╡ро▓рпНроХро│рпИ ро╡ро┤роЩрпНроХро╡рпБроорпН.",
        getDiagnosisButton: "роЗро▒рпБродро┐ роирпЗро╛ропрпН роХрогрпНроЯро▒ро┐родро▓рпИрокрпН рокрпЖро▒рпБроХ",
        resultsTitle: "роЗро▒рпБродро┐ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ",
        resetButton: "рооро▒рпНро▒рпКро░рпБ рокропро┐ро░рпИ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН",
        diseaseSectionTitle: "роЗро▒роирпНрод роЗродроп роЕро▒ро┐роХрпБро▒ро┐роХро│рпН",
        insectSectionTitle: "ро▓ро╛ро░рпНро╡ро╛ роЕро▒ро┐роХрпБро▒ро┐роХро│рпН",
        yes: "роЖроорпН",
        no: "роЗро▓рпНро▓рпИ",
        diseaseAnalysisTitle: "ЁЯМ┐ роирпЛропрпН рокроХрпБрокрпНрокро╛ропрпНро╡рпБ ( роЗро▒роирпНрод роЗродропроорпН)",
        insectAnalysisTitle: "ЁЯРЫ рокрпВроЪрпНроЪро┐ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ",
        finalDiagnosisLabel: "роЗро▒рпБродро┐ роирпЗро╛ропрпН роХрогрпНроЯро▒ро┐родро▓рпН:",
        visualDetectionLabel: "роХро╛роЯрпНроЪро┐ роХрогрпНроЯро▒ро┐родро▓рпН (рокроЯроорпН):",
        symptomAnalysisLabel: "роЕро▒ро┐роХрпБро▒ро┐ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ (роЯро╛рокрпНроирпЖроЯрпН):",
        fusedCertaintyLabel: "роЗрогрпИроирпНрод роЙро▒рпБродро┐:",
        // Dynamic Questions (Translated to Tamil)
        dynamic_questions: {
            "Have you seen the central growing point of the stalk damaged or dead?": "родрогрпНроЯро┐ройрпН роорпИроп ро╡ро│ро░рпНроЪрпНроЪро┐рокрпН рокрпБро│рпНро│ро┐ роЪрпЗродроороЯрпИроирпНродродрпИропрпЛ роЕро▓рпНро▓родрпБ роЗро▒роирпНродродрпИропрпЛ рокро╛ро░рпНродрпНродро┐ро░рпБроХрпНроХро┐ро▒рпАро░рпНроХро│ро╛?",
            "Is the dead central shoot straw-coloured?": "роЗро▒роирпНрод роорпИропродрпН родрогрпНроЯрпБ ро╡рпИроХрпНроХрпЛро▓рпН роиро┐ро▒родрпНродро┐ро▓рпН роЙро│рпНро│родро╛?",
            "After pulling the dead-heart, do you find maggots that look like secondary feeders (not primary borers)?": "роЗро▒роирпНрод роЗродропродрпНродрпИ роЗро┤рпБродрпНрод рокро┐ро▒роХрпБ, роЗро░рогрпНроЯро╛роорпН роиро┐ро▓рпИ роЙрогрпНрогро┐роХро│ро╛роХродрпН родрпЛро▒рпНро▒рооро│ро┐роХрпНроХрпБроорпН рокрпБро┤рпБроХрпНроХро│рпИ (роорпБродройрпНроорпИ родрпБро│рпИрокрпНрокро╛ройрпНроХро│рпН роЕро▓рпНро▓) роХро╛рогрпНроХро┐ро▒рпАро░рпНроХро│ро╛?",
            "After pulling the dead-heart, do you find fresh live larvae inside the affected stem?": "роЗро▒роирпНрод роЗродропродрпНродрпИ роЗро┤рпБродрпНрод рокро┐ро▒роХрпБ, рокро╛родро┐роХрпНроХрокрпНрокроЯрпНроЯ родрогрпНроЯрпБроХрпНроХрпБро│рпН рокрпБродро┐роп роЙропро┐ро░рпБро│рпНро│ рокрпБро┤рпБроХрпНроХро│рпИроХрпН роХро╛рогрпНроХро┐ро▒рпАро░рпНроХро│ро╛?",
            "Is most of the visible damage inside the stem rather than outside?": "ро╡рпЖро│ро┐рокрпНрокроХрпНроХродрпНродрпИ ро╡ро┐роЯ родрогрпНроЯрпБроХрпНроХрпБро│рпН родро╛ройрпН роЕродро┐роХ роЪрпЗродроорпН родрпЖро░ро┐роХро┐ро▒родро╛?",
            "Have you noticed insect attack when the leaves are still developing and soft?": "роЗро▓рпИроХро│рпН роЗройрпНройрпБроорпН ро╡ро│ро░рпНроирпНродрпБ роорпЖройрпНроорпИропро╛роХ роЗро░рпБроХрпНроХрпБроорпНрокрпЛродрпБ рокрпВроЪрпНроЪро┐ родро╛роХрпНроХрпБродро▓рпИроХрпН роХро╡ройро┐родрпНродро┐ро░рпБроХрпНроХро┐ро▒рпАро░рпНроХро│ро╛?",
            "Was the crop planted within the last 15 days?": "роХроЯроирпНрод 15 роиро╛роЯрпНроХро│рпБроХрпНроХрпБро│рпН рокропро┐ро░рпН роироЯрокрпНрокроЯрпНроЯродро╛?",
            "Have you never seen moths flying during daytime?": "рокроХро▓рпН роирпЗро░родрпНродро┐ро▓рпН роЕроирпНродрпБрокрпНрокрпВроЪрпНроЪро┐роХро│рпН рокро▒рокрпНрокродрпИ роирпАроЩрпНроХро│рпН рокро╛ро░рпНродрпНродродрпЗ роЗро▓рпНро▓рпИропро╛?",
            "Have you observed mating or egg-laying activity mostly at night?": "рокрпЖро░рпБроорпНрокро╛ро▓рпБроорпН роЗро░ро╡ро┐ро▓рпН роЗройроЪрпНроЪрпЗро░рпНроХрпНроХрпИ роЕро▓рпНро▓родрпБ роорпБроЯрпНроЯрпИропро┐роЯрпБроорпН роЪрпЖропро▓рпИроХрпН роХро╡ройро┐родрпНродро┐ро░рпБроХрпНроХро┐ро▒рпАро░рпНроХро│ро╛?",
            "Were any biological control insects released in the field?": "ро╡ропро▓ро┐ро▓рпН роПродрпЗройрпБроорпН роЙропро┐ро░ро┐ропро▓рпН роХроЯрпНроЯрпБрокрпНрокро╛роЯрпНроЯрпБ рокрпВроЪрпНроЪро┐роХро│рпН ро╡ро┐роЯрокрпНрокроЯрпНроЯродро╛?",
            "Have you seen fully grown moths that are straw to light brown in colour?": "ро╡рпИроХрпНроХрпЛро▓рпН роорпБродро▓рпН ро╡рпЖро│ро┐ро░рпН рокро┤рпБрокрпНрокрпБ роиро┐ро▒родрпНродро┐ро▓рпН роорпБро┤рпБроорпИропро╛роХ ро╡ро│ро░рпНроирпНрод роЕроирпНродрпБрокрпНрокрпВроЪрпНроЪро┐роХро│рпИрокрпН рокро╛ро░рпНродрпНродро┐ро░рпБроХрпНроХро┐ро▒рпАро░рпНроХро│ро╛?",
            "Is the central shoot of young plants dry, brown, or straw-colored?": "роЗро│роорпН родро╛ро╡ро░роЩрпНроХро│ро┐ройрпН роорпИропродрпН родрогрпНроЯрпБ роХро╛ропрпНроирпНрод, рокро┤рпБрокрпНрокрпБ роЕро▓рпНро▓родрпБ ро╡рпИроХрпНроХрпЛро▓рпН роиро┐ро▒родрпНродро┐ро▓рпН роЙро│рпНро│родро╛?",
            "Does the central shoot come out easily when pulled gently?": "роорпЖродрпБро╡ро╛роХ роЗро┤рпБроХрпНроХрпБроорпНрокрпЛродрпБ роорпИропродрпН родрогрпНроЯрпБ роОро│ро┐родро┐ро▓рпН ро╡рпЖро│ро┐ропрпЗ ро╡ро░рпБроХро┐ро▒родро╛?",
            "Does the pulled shoot emit a foul or rotten odor?": "роЗро┤рпБроХрпНроХрокрпНрокроЯрпНроЯ родрогрпНроЯрпБ родрпБро░рпНроиро╛ро▒рпНро▒роорпН роЕро▓рпНро▓родрпБ роЕро┤рпБроХро┐роп ро╡ро╛роЪройрпИропрпИ ро╡рпЖро│ро┐ропро┐роЯрпБроХро┐ро▒родро╛?",
            "Are leaves around the central shoot yellowing, wilting, or drying?": "роорпИропродрпН родрогрпНроЯрпИроЪрпН роЪрпБро▒рпНро▒ро┐ропрпБро│рпНро│ роЗро▓рпИроХро│рпН роороЮрпНроЪро│рпН, ро╡ро╛роЯро▓рпН роЕро▓рпНро▓родрпБ роХро╛ропрпНроирпНродрпБ рокрпЛроХро┐ройрпНро▒ройро╡ро╛?",
            "Do patches of plants show multiple stalks with dried or dead centers?": "родро╛ро╡ро░роЩрпНроХро│ро┐ройрпН родро┐роЯрпНроЯрпБроХро│ро┐ро▓рпН роХро╛ропрпНроирпНрод роЕро▓рпНро▓родрпБ роЗро▒роирпНрод роорпИропроЩрпНроХро│рпИроХрпН роХрпКрогрпНроЯ рокро▓ родрогрпНроЯрпБроХро│рпН родрпЖройрпНрокроЯрпБроХро┐ройрпНро▒ройро╡ро╛?",
            "Has the percentage of dead hearts increased after recent rains or waterlogging?": "роЪроорпАрокродрпНродро┐роп рооро┤рпИ роЕро▓рпНро▓родрпБ роирпАро░рпН родрпЗроХрпНроХродрпНродро┐ро▒рпНроХрпБрокрпН рокро┐ро▒роХрпБ роЗро▒роирпНрод роЗродропроЩрпНроХро│ро┐ройрпН роЪродро╡рпАродроорпН роЕродро┐роХро░ро┐родрпНродрпБро│рпНро│родро╛?",
            "Are affected plants stunted or shorter than surrounding healthy plants?": "рокро╛родро┐роХрпНроХрокрпНрокроЯрпНроЯ родро╛ро╡ро░роЩрпНроХро│рпН роЪрпБро▒рпНро▒ро┐ропрпБро│рпНро│ роЖро░рпЛроХрпНроХро┐ропрооро╛рой родро╛ро╡ро░роЩрпНроХро│рпИ ро╡ро┐роЯ роХрпБроЯрпНроЯрпИропро╛роХро╡рпЛ роЕро▓рпНро▓родрпБ ро╡ро│ро░рпНроЪрпНроЪро┐роХрпН роХрпБройрпНро▒ро┐ропрпЛ роЙро│рпНро│родро╛?",
            "Do affected plants fail to produce new green shoots or leaves?": "рокро╛родро┐роХрпНроХрокрпНрокроЯрпНроЯ родро╛ро╡ро░роЩрпНроХро│рпН рокрпБродро┐роп рокроЪрпНроЪрпИ родро│ро┐ро░рпНроХро│рпН роЕро▓рпНро▓родрпБ роЗро▓рпИроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХродрпН родро╡ро▒рпБроХро┐ройрпНро▒ройро╡ро╛?",
            "Are there soft, hollow, or tunnel-like areas inside the affected stalks?": "рокро╛родро┐роХрпНроХрокрпНрокроЯрпНроЯ родрогрпНроЯрпБроХро│рпБроХрпНроХрпБро│рпН роорпЖройрпНроорпИропро╛рой, роЙро│рпНро│рпАроЯро▒рпНро▒ роЕро▓рпНро▓родрпБ роЪрпБро░роЩрпНроХроорпН рокрпЛройрпНро▒ рокроХрпБродро┐роХро│рпН роЙро│рпНро│родро╛?",
            "Have you seen bunchy or abnormal growth at the top of affected stalks?": "рокро╛родро┐роХрпНроХрокрпНрокроЯрпНроЯ родрогрпНроЯрпБроХро│ро┐ройрпН роЙроЪрпНроЪро┐ропро┐ро▓рпН роХрпКродрпНродро╛рой роЕро▓рпНро▓родрпБ роЕроЪро╛родро╛ро░рог ро╡ро│ро░рпНроЪрпНроЪро┐ропрпИроХрпН роХрогрпНроЯро┐ро░рпБроХрпНроХро┐ро▒рпАро░рпНроХро│ро╛?",
            "Are soil moisture and drainage poor in areas where dead hearts appear?": "роЗро▒роирпНрод роЗродропроЩрпНроХро│рпН родрпЛройрпНро▒рпБроорпН рокроХрпБродро┐роХро│ро┐ро▓рпН роорогрпН роИро░роорпН рооро▒рпНро▒рпБроорпН ро╡роЯро┐роХро╛ро▓рпН роорпЛроЪрооро╛роХ роЙро│рпНро│родро╛?",
            "Are there no dry central shoots in the field?": "ро╡ропро▓ро┐ро▓рпН роХро╛ропрпНроирпНрод роорпИропродрпН родрогрпНроЯрпБроХро│рпН роОродрпБро╡рпБроорпН роЗро▓рпНро▓рпИропро╛?",
            "Is plant height uniform and normal throughout the field?": "ро╡ропро▓рпН роорпБро┤рпБро╡родрпБроорпН родро╛ро╡ро░родрпНродро┐ройрпН роЙропро░роорпН роЪрпАро░ро╛роХро╡рпБроорпН роЪро╛родро╛ро░рогрооро╛роХро╡рпБроорпН роЙро│рпНро│родро╛?",
            "When pulling the central shoot, is it firmly attached without coming out easily?": "роорпИропродрпН родрогрпНроЯрпИ роЗро┤рпБроХрпНроХрпБроорпНрокрпЛродрпБ, роЕродрпБ роОро│ро┐родро┐ро▓рпН ро╡рпЖро│ро┐ропрпЗ ро╡ро░ро╛рооро▓рпН роЙро▒рпБродро┐ропро╛роХ роЗрогрпИроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родро╛?",
            "Does the shoot base smell fresh with no rotting or foul odor?": "родрогрпНроЯро┐ройрпН роЕроЯро┐рокрпНрокроХрпБродро┐ роЕро┤рпБроХро▓рпН роЕро▓рпНро▓родрпБ родрпБро░рпНроиро╛ро▒рпНро▒роорпН роЗро▓рпНро▓ро╛рооро▓рпН р░др░╛р░Ьр░╛р░Чр░╛ роорогроХрпНроХро┐ро▒родро╛?",
            "Are leaves healthy, green, and not wilting near the central shoot?": "роорпИропродрпН родрогрпНроЯрпБроХрпНроХрпБ роЕро░рпБроХро┐ро▓рпН роЙро│рпНро│ роЗро▓рпИроХро│рпН роЖро░рпЛроХрпНроХро┐ропрооро╛роХро╡рпБроорпН, рокроЪрпНроЪрпИропро╛роХро╡рпБроорпН, ро╡ро╛роЯро╛рооро▓рпБроорпН роЙро│рпНро│родро╛?",
            "Do you have no patches with multiple dead or dried shoots?": "рокро▓ роЗро▒роирпНрод роЕро▓рпНро▓родрпБ роХро╛ропрпНроирпНрод родро│ро┐ро░рпНроХро│рпН роХрпКрогрпНроЯ родро┐роЯрпНроЯрпБроХро│рпН роЙроЩрпНроХро│ро┐роЯроорпН роЗро▓рпНро▓рпИропро╛?",
            "Have symptoms decreased after improved irrigation or fertilization?": "роорпЗроорпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ роирпАро░рпНрокрпНрокро╛роЪройроорпН роЕро▓рпНро▓родрпБ роЙро░рооро┐роЯрпНроЯ рокро┐ро▒роХрпБ роЕро▒ро┐роХрпБро▒ро┐роХро│рпН роХрпБро▒рпИроирпНродрпБро╡ро┐роЯрпНроЯродро╛?",
            "Is there no recurrence of dead heart symptoms from previous seasons?": "роорпБроирпНродрпИроп рокро░рпБро╡роЩрпНроХро│ро┐ро▓ро┐ро░рпБроирпНродрпБ роЗро▒роирпНрод роЗродроп роЕро▒ро┐роХрпБро▒ро┐роХро│рпН роорпАрогрпНроЯрпБроорпН роПро▒рпНрокроЯро╡ро┐ро▓рпНро▓рпИропро╛?"
        }
    },
    hi: {
        // Static UI Text
        headerTitle: "ЁЯзСтАНЁЯМ╛ рдПрдЧреНрд░реА-рдПрдЖрдИ рдирд┐рджрд╛рди",
        headerLead: "рд╕рдВрдкреВрд░реНрдг рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдлрд╕рд▓ рдпрд╛ рдХреАрдЯ рдХреА рдЫрд╡рд┐ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВред",
        translateButton: "рдЕрдиреБрд╡рд╛рдж",
        step1Title: "рдЪрд░рдг 1: рдЪрд┐рддреНрд░ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ",
        uploadLabel: "ЁЯМ┐ рдЪрд┐рддреНрд░ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ (рдлрд╕рд▓ рдпрд╛ рдХреАрдЯ)",
        analyzeButton: "рдЪрд┐рддреНрд░ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ",
        loadingSpinner: "рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...",
        step2Title: "рдЪрд░рдг 2: рдХреБрдЫ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рдЙрддреНрддрд░ рджреЗрдВ",
        step2Lead: "рдХреГрдкрдпрд╛ рдиреАрдЪреЗ рджреА рдЧрдИ рдЫрд╡рд┐ рдФрд░ рдЕрдкрдиреЗ рдЕрд╡рд▓реЛрдХрдиреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░реЗрдВред",
        getDiagnosisButton: "рдЕрдВрддрд┐рдо рдирд┐рджрд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ",
        resultsTitle: "рдЕрдВрддрд┐рдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг",
        resetButton: "рджреВрд╕рд░реА рдлрд╕рд▓ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ",
        diseaseSectionTitle: "рдбреЗрдб-рд╣рд╛рд░реНрдЯ рдХреЗ рд▓рдХреНрд╖рдг",
        insectSectionTitle: "рд▓рд╛рд░реНрд╡рд╛ рдХреЗ рд▓рдХреНрд╖рдг",
        yes: "рд╣рд╛рдБ",
        no: "рдирд╣реАрдВ",
        diseaseAnalysisTitle: "ЁЯМ┐ рд░реЛрдЧ рд╡рд┐рд╢реНрд▓реЗрд╖рдг (рдбреЗрдб рд╣рд╛рд░реНрдЯ)",
        insectAnalysisTitle: "ЁЯРЫ рдХреАрдЯ рд╡рд┐рд╢реНрд▓реЗрд╖рдг",
        finalDiagnosisLabel: "рдЕрдВрддрд┐рдо рдирд┐рджрд╛рди:",
        visualDetectionLabel: "рджреГрд╢реНрдп рдкрд╣рдЪрд╛рди (рдЫрд╡рд┐):",
        symptomAnalysisLabel: "рд▓рдХреНрд╖рдг рд╡рд┐рд╢реНрд▓реЗрд╖рдг (рдЯреИрдмрдиреЗрдЯ):",
        fusedCertaintyLabel: "рд╕рдВрдпреБрдХреНрдд рдирд┐рд╢реНрдЪрд┐рддрддрд╛:",
        // Dynamic Questions (Translated to Hindi)
        dynamic_questions: {
            "Have you seen the central growing point of the stalk damaged or dead?": "рдХреНрдпрд╛ рдЖрдкрдиреЗ рдбрдВрдард▓ рдХреЗ рдХреЗрдВрджреНрд░реАрдп рд╡реГрджреНрдзрд┐ рдмрд┐рдВрджреБ рдХреЛ рдХреНрд╖рддрд┐рдЧреНрд░рд╕реНрдд рдпрд╛ рдореГрдд рджреЗрдЦрд╛ рд╣реИ?",
            "Is the dead central shoot straw-coloured?": "рдХреНрдпрд╛ рдореГрдд рдХреЗрдВрджреНрд░реАрдп рдЕрдВрдХреБрд░ рднреВрд╕реЗ рдХреЗ рд░рдВрдЧ рдХрд╛ рд╣реИ?",
            "After pulling the dead-heart, do you find maggots that look like secondary feeders (not primary borers)?": "рдбреЗрдб-рд╣рд╛рд░реНрдЯ рдЦреАрдВрдЪрдиреЗ рдХреЗ рдмрд╛рдж, рдХреНрдпрд╛ рдЖрдкрдХреЛ рджреНрд╡рд┐рддреАрдпрдХ рдлреАрдбрд░ (рдкреНрд░рд╛рдердорд┐рдХ рдмреЛрд░рд░реНрд╕ рдирд╣реАрдВ) рдЬреИрд╕реЗ рдореИрдЧреЙрдЯ рдорд┐рд▓рддреЗ рд╣реИрдВ?",
            "After pulling the dead-heart, do you find fresh live larvae inside the affected stem?": "рдбреЗрдб-рд╣рд╛рд░реНрдЯ рдЦреАрдВрдЪрдиреЗ рдХреЗ рдмрд╛рдж, рдХреНрдпрд╛ рдЖрдкрдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рддрдиреЗ рдХреЗ рдЕрдВрджрд░ рддрд╛рдЬрд╝реЗ рдЬреАрд╡рд┐рдд рд▓рд╛рд░реНрд╡рд╛ рдорд┐рд▓рддреЗ рд╣реИрдВ?",
            "Is most of the visible damage inside the stem rather than outside?": "рдХреНрдпрд╛ рдЕрдзрд┐рдХрд╛рдВрд╢ рджреГрд╢реНрдп рдХреНрд╖рддрд┐ рдмрд╛рд╣рд░ рдХреЗ рдмрдЬрд╛рдп рддрдиреЗ рдХреЗ рдЕрдВрджрд░ рд╣реИ?",
            "Have you noticed insect attack when the leaves are still developing and soft?": "рдХреНрдпрд╛ рдЖрдкрдиреЗ рдкрддреНрддрд┐рдпреЛрдВ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдФрд░ рдирд░рдо рд╣реЛрдиреЗ рдкрд░ рдХреАрдЯреЛрдВ рдХрд╛ рд╣рдорд▓рд╛ рджреЗрдЦрд╛ рд╣реИ?",
            "Was the crop planted within the last 15 days?": "рдХреНрдпрд╛ рдлрд╕рд▓ рдкрд┐рдЫрд▓реЗ 15 рджрд┐рдиреЛрдВ рдХреЗ рднреАрддрд░ рд▓рдЧрд╛рдИ рдЧрдИ рдереА?",
            "Have you never seen moths flying during daytime?": "рдХреНрдпрд╛ рдЖрдкрдиреЗ рджрд┐рди рдореЗрдВ рдкрддрдВрдЧреЛрдВ рдХреЛ рдЙрдбрд╝рддреЗ рд╣реБрдП рдХрднреА рдирд╣реАрдВ рджреЗрдЦрд╛ рд╣реИ?",
            "Have you observed mating or egg-laying activity mostly at night?": "рдХреНрдпрд╛ рдЖрдкрдиреЗ рдЬреНрдпрд╛рджрд╛рддрд░ рд░рд╛рдд рдореЗрдВ рд╕рдВрднреЛрдЧ рдпрд╛ рдЕрдВрдбреЗ рджреЗрдиреЗ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рджреЗрдЦреА рд╣реИ?",
            "Were any biological control insects released in the field?": "рдХреНрдпрд╛ рдЦреЗрдд рдореЗрдВ рдХреЛрдИ рдЬреИрд╡рд┐рдХ рдирд┐рдпрдВрддреНрд░рдг рдХреАрдбрд╝реЗ рдЫреЛрдбрд╝реЗ рдЧрдП рдереЗ?",
            "Have you seen fully grown moths that are straw to light brown in colour?": "рдХреНрдпрд╛ рдЖрдкрдиреЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╡рд┐рдХрд╕рд┐рдд рдкрддрдВрдЧреЗ рджреЗрдЦреЗ рд╣реИрдВ рдЬреЛ рднреВрд╕реЗ рд╕реЗ рд╣рд▓реНрдХреЗ рднреВрд░реЗ рд░рдВрдЧ рдХреЗ рд╣реЛрддреЗ рд╣реИрдВ?",
            "Is the central shoot of young plants dry, brown, or straw-colored?": "рдХреНрдпрд╛ рдпреБрд╡рд╛ рдкреМрдзреЛрдВ рдХрд╛ рдХреЗрдВрджреНрд░реАрдп рдЕрдВрдХреБрд░ рд╕реВрдЦрд╛, рднреВрд░рд╛ рдпрд╛ рднреВрд╕реЗ рдХреЗ рд░рдВрдЧ рдХрд╛ рд╣реЛрддрд╛ рд╣реИ?",
            "Does the central shoot come out easily when pulled gently?": "рдХреНрдпрд╛ рдзреАрд░реЗ рд╕реЗ рдЦреАрдВрдЪрдиреЗ рдкрд░ рдХреЗрдВрджреНрд░реАрдп рдЕрдВрдХреБрд░ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрд╛рд╣рд░ рдЖ рдЬрд╛рддрд╛ рд╣реИ?",
            "Does the pulled shoot emit a foul or rotten odor?": "рдХреНрдпрд╛ рдЦреАрдВрдЪреЗ рдЧрдП рдЕрдВрдХреБрд░ рд╕реЗ рджреБрд░реНрдЧрдВрдз рдпрд╛ рд╕рдбрд╝реА рд╣реБрдИ рдЧрдВрдз рдЖрддреА рд╣реИ?",
            "Are leaves around the central shoot yellowing, wilting, or drying?": "рдХреНрдпрд╛ рдХреЗрдВрджреНрд░реАрдп рдЕрдВрдХреБрд░ рдХреЗ рдЖрд╕рдкрд╛рд╕ рдХреА рдкрддреНрддрд┐рдпрд╛рдБ рдкреАрд▓реА рдкрдбрд╝ рд░рд╣реА рд╣реИрдВ, рдореБрд░рдЭрд╛ рд░рд╣реА рд╣реИрдВ рдпрд╛ рд╕реВрдЦ рд░рд╣реА рд╣реИрдВ?",
            "Do patches of plants show multiple stalks with dried or dead centers?": "рдХреНрдпрд╛ рдкреМрдзреЛрдВ рдХреЗ рдзрдмреНрдмреЛрдВ рдореЗрдВ рд╕реВрдЦреЗ рдпрд╛ рдореГрдд рдХреЗрдВрджреНрд░реЛрдВ рд╡рд╛рд▓реЗ рдХрдИ рдбрдВрдард▓ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ?",
            "Has the percentage of dead hearts increased after recent rains or waterlogging?": "рдХреНрдпрд╛ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рд╣реБрдИ рдмрд╛рд░рд┐рд╢ рдпрд╛ рдЬрд▓рднрд░рд╛рд╡ рдХреЗ рдмрд╛рдж рдбреЗрдб рд╣рд╛рд░реНрдЯ рдХрд╛ рдкреНрд░рддрд┐рд╢рдд рдмрдврд╝рд╛ рд╣реИ?",
            "Are affected plants stunted or shorter than surrounding healthy plants?": "рдХреНрдпрд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдкреМрдзреЗ рдЖрд╕рдкрд╛рд╕ рдХреЗ рд╕реНрд╡рд╕реНрде рдкреМрдзреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрд╡рд┐рдХрд╕рд┐рдд рдпрд╛ рдЫреЛрдЯреЗ рд╣реИрдВ?",
            "Do affected plants fail to produce new green shoots or leaves?": "рдХреНрдпрд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдкреМрдзреЗ рдирдП рд╣рд░реЗ рдЕрдВрдХреБрд░ рдпрд╛ рдкрддреНрддрд┐рдпрд╛рдВ рдкреИрджрд╛ рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ рд░рд╣рддреЗ рд╣реИрдВ?",
            "Are there soft, hollow, or tunnel-like areas inside the affected stalks?": "рдХреНрдпрд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдбрдВрдард▓реЛрдВ рдХреЗ рдЕрдВрджрд░ рдирд░рдо, рдЦреЛрдЦрд▓реЗ рдпрд╛ рд╕реБрд░рдВрдЧ рдЬреИрд╕реЗ рдХреНрд╖реЗрддреНрд░ рд╣реИрдВ?",
            "Have you seen bunchy or abnormal growth at the top of affected stalks?": "рдХреНрдпрд╛ рдЖрдкрдиреЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдбрдВрдард▓реЛрдВ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдЧреБрдЪреНрдЫреЗрджрд╛рд░ рдпрд╛ рдЕрд╕рд╛рдорд╛рдиреНрдп рд╡реГрджреНрдзрд┐ рджреЗрдЦреА рд╣реИ?",
            "Are soil moisture and drainage poor in areas where dead hearts appear?": "рдХреНрдпрд╛ рдЙрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдорд┐рдЯреНрдЯреА рдХреА рдирдореА рдФрд░ рдЬрд▓ рдирд┐рдХрд╛рд╕реА рдЦрд░рд╛рдм рд╣реИ рдЬрд╣рд╛рдБ рдбреЗрдб рд╣рд╛рд░реНрдЯ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ?",
            "Are there no dry central shoots in the field?": "рдХреНрдпрд╛ рдЦреЗрдд рдореЗрдВ рдХреЛрдИ рд╕реВрдЦреЗ рдХреЗрдВрджреНрд░реАрдп рдЕрдВрдХреБрд░ рдирд╣реАрдВ рд╣реИрдВ?",
            "Is plant height uniform and normal throughout the field?": "рдХреНрдпрд╛ рдкреВрд░реЗ рдЦреЗрдд рдореЗрдВ рдкреМрдзреЗ рдХреА рдКрдВрдЪрд╛рдИ рдПрдХ рд╕рдорд╛рди рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ?",
            "When pulling the central shoot, is it firmly attached without coming out easily?": "рдХреЗрдВрджреНрд░реАрдп рдЕрдВрдХреБрд░ рдХреЛ рдЦреАрдВрдЪрддреЗ рд╕рдордп, рдХреНрдпрд╛ рдпрд╣ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрд╛рд╣рд░ рдЖрдП рдмрд┐рдирд╛ рдордЬрдмреВрддреА рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИ?",
            "Does the shoot base smell fresh with no rotting or foul odor?": "рдХреНрдпрд╛ рдЕрдВрдХреБрд░ рдХреЗ рдЖрдзрд╛рд░ рд╕реЗ рд╕рдбрд╝рди рдпрд╛ рджреБрд░реНрдЧрдВрдз рдХреЗ рдмрд┐рдирд╛ рддрд╛рдЬрд╝рд╛ рдЧрдВрдз рдЖрддреА рд╣реИ?",
            "Are leaves healthy, green, and not wilting near the central shoot?": "рдХреНрдпрд╛ рдХреЗрдВрджреНрд░реАрдп рдЕрдВрдХреБрд░ рдХреЗ рдкрд╛рд╕ рдХреА рдкрддреНрддрд┐рдпрд╛рдБ рд╕реНрд╡рд╕реНрде, рд╣рд░реА рдФрд░ рдореБрд░рдЭрд╛рдИ рд╣реБрдИ рдирд╣реАрдВ рд╣реИрдВ?",
            "Do you have no patches with multiple dead or dried shoots?": "рдХреНрдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрдИ рдореГрдд рдпрд╛ рд╕реВрдЦреЗ рдЕрдВрдХреБрд░реЛрдВ рд╡рд╛рд▓реЗ рдХреЛрдИ рдзрдмреНрдмреЗ рдирд╣реАрдВ рд╣реИрдВ?",
            "Have symptoms decreased after improved irrigation or fertilization?": "рдХреНрдпрд╛ рдмреЗрд╣рддрд░ рд╕рд┐рдВрдЪрд╛рдИ рдпрд╛ рдЙрд░реНрд╡рд░реАрдХрд░рдг рдХреЗ рдмрд╛рдж рд▓рдХреНрд╖рдг рдХрдо рд╣реБрдП рд╣реИрдВ?",
            "Is there no recurrence of dead heart symptoms from previous seasons?": "рдХреНрдпрд╛ рдкрд┐рдЫрд▓реЗ рдореМрд╕рдореЛрдВ рд╕реЗ рдбреЗрдб рд╣рд╛рд░реНрдЯ рдХреЗ рд▓рдХреНрд╖рдгреЛрдВ рдХреА рдХреЛрдИ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдирд╣реАрдВ рд╣реБрдИ рд╣реИ?"
        }
    }
};

function translatePage() {
    document.querySelectorAll('[data-translate-key]').forEach(el => {
        const key = el.getAttribute('data-translate-key');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
            el.innerText = translations[currentLanguage][key];
        }
    });
    if (resultsCard.style.display === 'block' && analysisData.results) {
        displayResults(analysisData.results);
    }
}

function setLanguage(lang) {
    currentLanguage = lang;
    translatePage();
}

// ============== EXISTING CODE (with minimal fixes) ==============
const uploadForm = document.getElementById('upload-form');
const imageInput = document.getElementById('image-input');
const spinner = document.getElementById('spinner');
const resetBtn = document.getElementById('reset-btn');
const uploadCard = document.getElementById('upload-card');
const symptomCard = document.getElementById('symptom-card');
const symptomForm = document.getElementById('symptom-form');
const submitSymptomsBtn = document.getElementById('submit-symptoms');
const resultsCard = document.getElementById('results-card');
const resultsContent = document.getElementById('results-content');
const uploadedImagePreview = document.getElementById('uploaded-image-preview');
const imageTypeText = document.querySelector('#symptom-card .text-muted'); // More specific selector

let analysisData = {};

uploadForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    if (!imageInput.files[0]) { alert("Please select an image."); return; }
    spinner.style.display = 'block';
    const formData = new FormData();
    formData.append('image_file', imageInput.files[0]);
    try {
        const response = await fetch('/analyze', { method: 'POST', body: formData });
        if (!response.ok) throw new Error('Server error during image analysis.');
        analysisData = await response.json();
        uploadCard.style.display = 'none';
        uploadedImagePreview.src = analysisData.image_url;
        uploadedImagePreview.style.display = 'block';
        imageTypeText.textContent = analysisData.image_content_type;
        displayQuestions(analysisData);
        symptomCard.style.display = 'block';
    } catch (error) {
        console.error('Fetch Error:', error);
        alert('Could not connect to the server.');
    } finally {
        spinner.style.display = 'none';
    }
});

submitSymptomsBtn.addEventListener('click', async () => {
    const diseaseAnswers = Array.from(document.querySelectorAll('[name^="disease_"]:checked')).map(input => input.value);
    const insectAnswers = Array.from(document.querySelectorAll('[name^="insect_"]:checked')).map(input => input.value);
    const payload = {
        yolo_disease_output: analysisData.yolo_disease_output,
        yolo_insect_output: analysisData.yolo_insect_output,
        disease_answers: diseaseAnswers,
        insect_answers: insectAnswers
    };
    try {
        const response = await fetch('/fuse', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });
        if (!response.ok) throw new Error('Server error during fusion.');
        const finalResults = await response.json();
        analysisData.results = finalResults;
        symptomCard.style.display = 'none';
        displayResults(finalResults);
        resultsCard.style.display = 'block';
    } catch (error) {
        console.error('Fetch Error:', error);
        alert('Could not get final diagnosis.');
    }
});

resetBtn.addEventListener('click', () => { window.location.reload(); });

function displayQuestions(data) {
    symptomForm.innerHTML = '';
    let questionCount = 0;
    if (data.questions && data.questions.disease_questions) {
        const diseaseSection = createSection('diseaseSectionTitle');
        data.questions.disease_questions.forEach((q, i) => diseaseSection.appendChild(createQuestionElement(q, 'disease_', i)));
        symptomForm.appendChild(diseaseSection);
        questionCount += data.questions.disease_questions.length;
    }
    if (data.questions && data.questions.insect_questions) {
        const insectSection = createSection('insectSectionTitle');
        data.questions.insect_questions.forEach((q, i) => insectSection.appendChild(createQuestionElement(q, 'insect_', i)));
        symptomForm.appendChild(insectSection);
        questionCount += data.questions.insect_questions.length;
    }
    submitSymptomsBtn.style.display = questionCount > 0 ? 'block' : 'none';
}

function createSection(titleKey) {
    const section = document.createElement('div');
    section.className = 'question-section';
    section.innerHTML = `<h6>${translations[currentLanguage][titleKey]}</h6>`;
    return section;
}

function createQuestionElement(q, prefix, index) {
    const uniqueId = prefix + q.key; // Use the key from the backend
    const formGroup = document.createElement('div');
    formGroup.className = 'mb-3';
    formGroup.innerHTML = `
        <label class="form-label small">${(translations[currentLanguage].dynamic_questions[q.key]) || q.text}</label>
        <div>
            <input type="radio" class="btn-check" name="${uniqueId}" id="${uniqueId}-yes" value="yes" autocomplete="off" required>
            <label class="btn btn-outline-success btn-sm" for="${uniqueId}-yes">${translations[currentLanguage].yes}</label>
            <input type="radio" class="btn-check" name="${uniqueId}" id="${uniqueId}-no" value="no" autocomplete="off" checked>
            <label class="btn btn-outline-danger btn-sm" for="${uniqueId}-no">${translations[currentLanguage].no}</label>
        </div>
    `;
    return formGroup;
}

// In script.js

function displayResults(data) {
    const lang = translations[currentLanguage];
    const resultsContent = document.getElementById('results-content');
    resultsContent.innerHTML = ''; // Clear previous results

    // Helper function to determine text color based on diagnosis
    const getConfidenceClass = (diag) => {
        if (!diag) return "text-muted";
        if (diag.toLowerCase().includes("present") || diag.toLowerCase().includes("borer") || diag.toLowerCase().includes("unconfirmed")) {
            return "text-danger fw-bold";
        }
        if (diag.toLowerCase().includes("healthy") || diag.toLowerCase().includes("not present")) {
            return "text-success fw-bold";
        }
        return "text-dark";
    };

    // Check the analysis type sent from the backend
    if (data.analysis_type === 'disease') {
        const disease = data.result;
        resultsContent.innerHTML = `
            <div class="mb-3">
                <h6>${lang.diseaseAnalysisTitle}</h6>
                <p class="mb-1"><strong>${lang.finalDiagnosisLabel}</strong> <span class="${getConfidenceClass(disease.final_diagnosis)}">${disease.final_diagnosis}</span></p>
                <ul class="list-unstyled small text-muted">
                    <li>${lang.visualDetectionLabel} ${disease.yolo_output}</li>
                    <li>${lang.symptomAnalysisLabel} Prob. ${disease.tabnet_probability}</li>
                    <li>${lang.fusedCertaintyLabel} Prob. ${disease.fused_probability}</li>
                </ul>
            </div>
        `;
    } else if (data.analysis_type === 'insect') {
        const insect = data.result;
        resultsContent.innerHTML = `
            <div>
                <h6>${lang.insectAnalysisTitle}</h6>
                <p class="mb-1"><strong>${lang.finalDiagnosisLabel}</strong> <span class="${getConfidenceClass(insect.final_diagnosis)}">${insect.final_diagnosis}</span></p>
                <ul class="list-unstyled small text-muted">
                    <li>${lang.visualDetectionLabel} ${insect.yolo_output}</li>
                    <li>${lang.symptomAnalysisLabel} ${insect.tabnet_classification}</li>
                    <li>${lang.fusedCertaintyLabel} Prob. ${insect.fused_probability}</li>
                </ul>
            </div>
        `;
    }
}


document.addEventListener('DOMContentLoaded', () => { translatePage(); });